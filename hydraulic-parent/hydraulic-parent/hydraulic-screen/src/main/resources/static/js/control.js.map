{"version":3,"sources":["webpack:///static/js/control.js","webpack:///./src/pages/screen/control/vue/control.vue","webpack:///./src/common/lib/axios.js","webpack:///src/pages/screen/control/vue/control.vue","webpack:///./src/pages/screen/control/vue/control.vue?ca87","webpack:///./src/pages/screen/control/control.js"],"names":["webpackJsonp","+skl","module","exports","1","__webpack_require__","4OOE","HVf8","J9oB","__webpack_exports__","injectStyle","ssrContext","Object","defineProperty","value","vue","vue_default","n","iview","iview_default","vue_bus_esm","promise","promise_default","axios","axios_default","AjaxUtil","ROOT","ajax","create","baseURL","timeout","responseType","interceptors","response","use","data","error","reject","lib","lib_default","render","_vm","this","_h","$createElement","_c","_self","staticStyle","attrs","on","initAlarmDialog","_v","staticClass","slot","model","callback","$$v","outsideVal","expression","foreVal","class","isAlarm","insideVal","alarmDialogModal","closable","alarmDialogCancel","$set","ref","alarmForm","switchChange","scopedSlots","_u","key","fn","proxy","status","_l","f","index","_s","item","id","openid","nickName","loading","alarmDialogSubmit","staticRenderFns","esExports","normalizeComponent","__vue_styles__","Component","Vue","iView","VueBus","el","components","controlComponent"],"mappings":"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","file":"static/js/control.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ \"+skl\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 1:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(\"J9oB\");\n\n\n/***/ }),\n\n/***/ \"4OOE\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"HVf8\":\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ \"J9oB\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ./node_modules/vue/dist/vue.js\nvar vue = __webpack_require__(\"4bK6\");\nvar vue_default = /*#__PURE__*/__webpack_require__.n(vue);\n\n// EXTERNAL MODULE: ./node_modules/iview/dist/iview.js\nvar iview = __webpack_require__(\"BTaQ\");\nvar iview_default = /*#__PURE__*/__webpack_require__.n(iview);\n\n// EXTERNAL MODULE: ./node_modules/vue-bus/dist/vue-bus.esm.js\nvar vue_bus_esm = __webpack_require__(\"fC7K\");\n\n// EXTERNAL MODULE: ./node_modules/iview/dist/styles/iview.css\nvar styles_iview = __webpack_require__(\"+skl\");\nvar styles_iview_default = /*#__PURE__*/__webpack_require__.n(styles_iview);\n\n// EXTERNAL MODULE: ./src/common/css/common.css\nvar common = __webpack_require__(\"HVf8\");\nvar common_default = /*#__PURE__*/__webpack_require__.n(common);\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/core-js/promise.js\nvar promise = __webpack_require__(\"//Fk\");\nvar promise_default = /*#__PURE__*/__webpack_require__.n(promise);\n\n// EXTERNAL MODULE: ./node_modules/axios/index.js\nvar axios = __webpack_require__(\"mtWM\");\nvar axios_default = /*#__PURE__*/__webpack_require__.n(axios);\n\n// CONCATENATED MODULE: ./src/common/lib/axios.js\n\n\n\nvar AjaxUtil = {\n  ROOT: '/screen'\n};\n\nAjaxUtil.ajax = axios_default.a.create({\n  baseURL: AjaxUtil.ROOT,\n  timeout: 120000,\n  responseType: 'json'\n});\n\nAjaxUtil.ajax.interceptors.response.use(function (response) {\n  return response.data;\n}, function (error) {\n  return promise_default.a.reject(error);\n});\n\n/* harmony default export */ var lib_axios = (AjaxUtil);\n// EXTERNAL MODULE: ./node_modules/qs/lib/index.js\nvar lib = __webpack_require__(\"mw3O\");\nvar lib_default = /*#__PURE__*/__webpack_require__.n(lib);\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./node_modules/iview-loader??ref--0-1!./src/pages/screen/control/vue/control.vue\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n/* harmony default export */ var control = ({\n  name: 'control',\n  data: function data() {\n    return {\n      isAlarm: false,\n      insideVal: 0.01,\n      foreVal: 0.01,\n      outsideVal: 0.01,\n      timer: '',\n      receiverList: [],\n      frequencyList: [\"5\", \"10\", \"15\", \"30\", \"45\", \"60\"],\n      alarmDialogModal: {\n        modal: false,\n        closable: false,\n        loading: false\n      },\n      alarmForm: {\n        id: null,\n        stationId: 1,\n        alarmName: \"\",\n        alarmLine: 0.00,\n        frequency: 5,\n        receivers: [],\n        status: 0\n      }\n    };\n  },\n  methods: {\n    init: function init() {\n      var _this = this;\n\n      this.getWaterLine();\n      this.timer = setInterval(function () {\n        _this.getWaterLine();\n      }, 10000);\n    },\n    getWXReceivers: function getWXReceivers() {\n      var _this2 = this;\n\n      lib_axios.ajax.post('/control/getWXReceivers').then(function (data) {\n        if (null != data) {\n          ;\n          _this2.receiverList = data;\n        }\n      }).catch(function (reason) {\n        console.log(reason);\n      });\n    },\n    getWaterLine: function getWaterLine() {\n      var _this3 = this;\n\n      lib_axios.ajax.post('/control/getWaterLine?stationId=1').then(function (data) {\n        var code = data.code;\n        if (\"200\" !== code) {\n          return;\n        }\n        var alarmLine = data.alarmLine;\n        _this3.insideVal = data.insideVal;\n        _this3.outsideVal = data.outsideVal;\n        _this3.foreVal = data.foreVal;\n        if (alarmLine !== 0 && _this3.insideVal >= alarmLine) {\n          _this3.isAlarm = true;\n        } else {\n          _this3.isAlarm = false;\n        }\n      }).catch(function (reason) {\n        console.log(reason);\n      });\n    },\n    alarmDialogSubmit: function alarmDialogSubmit() {\n      var _this4 = this;\n\n      this.alarmDialogModal.loading = true;\n      if (!this.formValidate()) {\n        return;\n      }\n      var reqData = lib_default.a.stringify(this.alarmForm, { allowDots: true });\n      lib_axios.ajax.post('/control/alarmConfigSave', reqData).then(function (resp) {\n        if (resp) {\n          _this4.$Message.success('报警设置成功！');\n        } else {\n          _this4.confirmAlert('报警设置失败！');\n        }\n      }).catch(function (reason) {\n        console.log(reason);\n      });\n      this.alarmDialogCancel();\n    },\n    formValidate: function formValidate() {\n      if (this.alarmForm.alarmName == '') {\n        this.confirmAlert('报警名称不能为空');\n        return false;\n      }\n      if (this.alarmForm.alarmLine == '') {\n        this.confirmAlert('报警水位不能为空');\n        return false;\n      }\n      if (this.alarmForm.receivers.length == 0) {\n        this.confirmAlert('通知人不能为空');\n        return false;\n      }\n      return true;\n    },\n    confirmAlert: function confirmAlert(message) {\n      var content = '<p>' + message + '</p>';\n      this.$Message.warning({\n        content: content,\n        duration: 3\n      });\n    },\n    alarmMessage: function alarmMessage(alarmLine) {\n      this.$Message.error({\n        background: true,\n        content: '当前内河水位已超' + alarmLine + '米的警戒水位，请及时处置！',\n        top: 50,\n        duration: 3\n      });\n    },\n    switchChange: function switchChange(flag) {\n      this.alarmForm.status = flag ? 1 : 0;\n    },\n    initAlarmDialog: function initAlarmDialog() {\n      var _this5 = this;\n\n      this.getWXReceivers();\n      lib_axios.ajax.post('/control/getAlarmConfig?stationId=' + this.alarmForm.stationId).then(function (form) {\n        if (form) {\n          _this5.alarmForm.id = form.id;\n          _this5.alarmForm.alarmName = form.alarmName;\n          _this5.alarmForm.alarmLine = form.alarmLine;\n          _this5.alarmForm.receivers = form.receivers;\n          _this5.alarmForm.frequency = form.frequency;\n          _this5.alarmForm.status = form.status;\n        }\n        _this5.alarmDialogModal.modal = true;\n      }).catch(function (reason) {\n        console.log(reason);\n      });\n    },\n    alarmDialogCancel: function alarmDialogCancel() {\n      this.alarmDialogModal.modal = false;\n      this.alarmDialogModal.closable = true;\n      this.alarmDialogModal.loading = false;\n      this.alarmForm.id = null;\n      this.alarmForm.status = 0;\n      this.alarmForm.frequency = 5;\n      this.alarmForm.alarmName = \"\";\n      this.alarmForm.alarmLine = 0.00;\n      this.alarmForm.receivers = [];\n    }\n  },\n  created: function created() {\n    this.init();\n  },\n  beforeDestroy: function beforeDestroy() {\n    clearInterval(this.timer);\n  }\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-840783ea\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/iview-loader??ref--0-1!./src/pages/screen/control/vue/control.vue\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"margin\":\"10px\"}},[_c('Button',{staticStyle:{\"margin-left\":\"22px\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.initAlarmDialog}},[_vm._v(\"水位报警设置\")]),_vm._v(\" \"),_c('card',{staticClass:\"card-top\",attrs:{\"dis-hover\":\"\"}},[_c('p',{staticStyle:{\"text-align\":\"center\"},attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"宣城市宣州区敬亭圩排涝站水位监测\")]),_vm._v(\" \"),_c('card',{staticClass:\"card-content\"},[_vm._v(\"\\n      外河水位：\"),_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"readonly\":\"\"},model:{value:(_vm.outsideVal),callback:function ($$v) {_vm.outsideVal=$$v},expression:\"outsideVal\"}}),_vm._v(\" 米\\n    \")],1),_vm._v(\" \"),_c('card',{staticClass:\"card-building\"},[_vm._v(\"\\n      泵站机房\\n    \")]),_vm._v(\" \"),_c('card',{staticClass:\"card-content\"},[_vm._v(\"\\n      前池水位：\"),_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"readonly\":\"\"},model:{value:(_vm.foreVal),callback:function ($$v) {_vm.foreVal=$$v},expression:\"foreVal\"}}),_vm._v(\" 米\\n    \")],1),_vm._v(\" \"),_c('card',{staticClass:\"card-content\",class:_vm.isAlarm ? 'warnFont' : ''},[_vm._v(\"\\n      内河水位：\"),_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"readonly\":\"\"},model:{value:(_vm.insideVal),callback:function ($$v) {_vm.insideVal=$$v},expression:\"insideVal\"}}),_vm._v(\" 米\\n    \")],1)],1),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"水位告警配置\",\"closable\":false,\"width\":\"45\",\"closable\":\"\",\"mask-closable\":_vm.alarmDialogModal.closable},on:{\"on-cancel\":_vm.alarmDialogCancel},model:{value:(_vm.alarmDialogModal.modal),callback:function ($$v) {_vm.$set(_vm.alarmDialogModal, \"modal\", $$v)},expression:\"alarmDialogModal.modal\"}},[_c('Form',{ref:\"alarmForm\",attrs:{\"model\":_vm.alarmForm,\"label-width\":90}},[_c('FormItem',{attrs:{\"label\":\"告警名称:\",\"prop\":\"alarmName\"}},[_c('Input',{staticStyle:{\"width\":\"400px\"},attrs:{\"placeholder\":\"请输入告警名称\",\"maxlength\":64},model:{value:(_vm.alarmForm.alarmName),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"alarmName\", $$v)},expression:\"alarmForm.alarmName\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"告警水位:\",\"prop\":\"alarmLine\"}},[_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"type\":\"number\"},model:{value:(_vm.alarmForm.alarmLine),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"alarmLine\", $$v)},expression:\"alarmForm.alarmLine\"}}),_vm._v(\" 米\\n      \")],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"告警开关:\",\"prop\":\"status\"}},[_c('i-switch',{attrs:{\"size\":\"large\"},on:{\"on-change\":_vm.switchChange},scopedSlots:_vm._u([{key:\"open\",fn:function(){return [_c('span',[_vm._v(\"ON\")])]},proxy:true},{key:\"close\",fn:function(){return [_c('span',[_vm._v(\"OFF\")])]},proxy:true}]),model:{value:(_vm.alarmForm.status ==1 ?true :false),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"status ==1 ?true :false\", $$v)},expression:\"alarmForm.status ==1 ?true :false\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"告警频率:\",\"prop\":\"frequency\"}},[_c('Select',{staticStyle:{\"width\":\"100px\"},model:{value:(_vm.alarmForm.frequency),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"frequency\", $$v)},expression:\"alarmForm.frequency\"}},_vm._l((_vm.frequencyList),function(f,index){return _c('Option',{key:index,attrs:{\"value\":f}},[_vm._v(_vm._s(f)+\"分钟/次\")])}),1)],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"通知人:\",\"prop\":\"receivers\"}},[_c('Select',{staticStyle:{\"width\":\"400px\"},attrs:{\"multiple\":\"\",\"filterable\":\"\",\"placeholder\":\"请选择通知人\"},model:{value:(_vm.alarmForm.receivers),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"receivers\", $$v)},expression:\"alarmForm.receivers\"}},_vm._l((_vm.receiverList),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.openid}},[_vm._v(_vm._s(item.nickName))])}),1)],1)],1),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{attrs:{\"type\":\"text\",\"size\":\"large\"},on:{\"click\":_vm.alarmDialogCancel}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"loading\":_vm.alarmDialogModal.loading},on:{\"click\":_vm.alarmDialogSubmit}},[_vm._v(\"保存\\n      \")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ var vue_control = (esExports);\n// CONCATENATED MODULE: ./src/pages/screen/control/vue/control.vue\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"4OOE\")\n}\nvar normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  control,\n  vue_control,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ var control_vue_control = (Component.exports);\n\n// CONCATENATED MODULE: ./src/pages/screen/control/control.js\n\n\n\n\n\n/** 自定义全局样式 **/\n\n\n\n\nvue_default.a.use(iview_default.a);\nvue_default.a.use(vue_bus_esm[\"a\" /* default */]);\n\nnew vue_default.a({\n  el: '#control',\n  components: { 'control-component': control_vue_control }\n});\n\n/***/ })\n\n},[1]);\n\n\n// WEBPACK FOOTER //\n// static/js/control.js","function injectStyle (ssrContext) {\n  require(\"!!../../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-840783ea\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!../../../../../node_modules/iview-loader/index.js??ref--0-1!./control.vue\")\n}\nvar normalizeComponent = require(\"!../../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!../../../../../node_modules/iview-loader/index.js??ref--0-1!./control.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../../node_modules/vue-loader/lib/selector?type=script&index=0!../../../../../node_modules/iview-loader/index.js??ref--0-1!./control.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-840783ea\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../../node_modules/vue-loader/lib/selector?type=template&index=0!../../../../../node_modules/iview-loader/index.js??ref--0-1!./control.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/screen/control/vue/control.vue\n// module id = null\n// module chunks = ","import axios from 'axios'\n\nconst AjaxUtil = {\n  ROOT: '/screen'\n}\n\nAjaxUtil.ajax = axios.create({\n  baseURL: AjaxUtil.ROOT,\n  timeout: 120000,\n  responseType: 'json'\n})\n\nAjaxUtil.ajax.interceptors.response.use(\n  function (response) {\n    return response.data\n  },\n  function (error) {\n    return Promise.reject(error)\n  }\n)\n\nexport default AjaxUtil\n\n\n\n// WEBPACK FOOTER //\n// ./src/common/lib/axios.js","<template>\n  <!--search-->\n  <div style=\"margin:10px\">\n    <Button type=\"primary\" @click=\"initAlarmDialog\" style=\"margin-left: 22px\">水位报警设置</Button>\n    <card dis-hover class=\"card-top\">\n      <p slot=\"title\" style=\"text-align: center\">宣城市宣州区敬亭圩排涝站水位监测</p>\n      <card class=\"card-content\">\n        外河水位：<Input v-model=\"outsideVal\" style=\"width: 70px;\" readonly/>&nbsp;米\n      </card>\n      <card class=\"card-building\">\n        泵站机房\n      </card>\n      <card class=\"card-content\">\n        前池水位：<Input v-model=\"foreVal\" style=\"width: 70px;\" readonly/>&nbsp;米\n      </card>\n      <card class=\"card-content\"  :class=\"isAlarm ? 'warnFont' : '' \">\n        内河水位：<Input v-model=\"insideVal\" style=\"width: 70px;\"  readonly/>&nbsp;米\n      </card>\n    </card>\n    <Modal title=\"水位告警配置\" v-bind:closable='false' width=\"45\" v-model='alarmDialogModal.modal' closable\n           @on-cancel=\"alarmDialogCancel\"\n           :mask-closable=\"alarmDialogModal.closable\">\n\n      <Form :model=\"alarmForm\" ref=\"alarmForm\" :label-width=\"90\">\n        <FormItem label=\"告警名称:\" prop=\"alarmName\">\n          <Input v-model=\"alarmForm.alarmName\" placeholder=\"请输入告警名称\" style=\"width:400px\"\n                 :maxlength=\"64\"/>\n        </FormItem>\n        <FormItem label=\"告警水位:\" prop=\"alarmLine\">\n          <Input type=\"number\" v-model=\"alarmForm.alarmLine\" style=\"width: 70px\"/>&nbsp;米\n        </FormItem>\n        <FormItem label=\"告警开关:\" prop=\"status\">\n          <i-switch size=\"large\" v-model=\"alarmForm.status ==1 ?true :false\" @on-change=\"switchChange\">\n            <template #open>\n              <span>ON</span>\n            </template>\n            <template #close>\n              <span>OFF</span>\n            </template>\n          </i-switch>\n        </FormItem>\n        <FormItem label=\"告警频率:\" prop=\"frequency\">\n          <Select v-model=\"alarmForm.frequency\"  style=\"width: 100px;\" >\n            <Option v-for=\"(f,index) in frequencyList\" :value=\"f\" :key=\"index\">{{f}}分钟/次</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"通知人:\" prop=\"receivers\">\n          <Select v-model=\"alarmForm.receivers\" multiple filterable style=\"width: 400px;\" placeholder=\"请选择通知人\">\n            <Option v-for=\"item in receiverList\" :value=\"item.openid\" :key=\"item.id\">{{item.nickName}}</Option>\n          </Select>\n        </FormItem>\n      </Form>\n      <div slot='footer'>\n        <Button type='text' size='large' @click='alarmDialogCancel'>取消</Button>\n        <Button type='primary' size='large' :loading=\"alarmDialogModal.loading\" @click='alarmDialogSubmit'>保存\n        </Button>\n      </div>\n    </Modal>\n  </div>\n</template>\n\n<script>\n  import $ from '../../../../common/lib/axios.js'\n  import Qs from 'qs'\n\n  export default {\n    name: 'control',\n    data: function () {\n      return {\n        isAlarm:false,\n        insideVal: 0.01,\n        foreVal: 0.01,\n        outsideVal: 0.01,\n        timer: '',\n        receiverList:[],\n        frequencyList:[\"5\",\"10\",\"15\",\"30\",\"45\",\"60\"],\n        alarmDialogModal: {\n          modal: false,\n          closable: false,\n          loading: false\n        },\n        alarmForm: {\n          id: null,\n          stationId: 1,\n          alarmName: \"\",\n          alarmLine: 0.00,\n          frequency:5,\n          receivers: [],\n          status: 0\n        }\n      }\n    },\n    methods: {\n      init: function () {\n        this.getWaterLine()\n        this.timer = setInterval(() => {\n          this.getWaterLine()\n        }, 10000)\n      },\n      getWXReceivers:function(){\n        $.ajax.post('/control/getWXReceivers')\n          .then(data => {\n            if(null!=data){;\n              this.receiverList=data\n            }\n          }).catch(function (reason) {\n          console.log(reason)\n        })\n      },\n      getWaterLine: function () {\n        $.ajax.post('/control/getWaterLine?stationId=1')\n          .then(data => {\n            let code = data.code;\n            if (\"200\" !== code) {\n              return\n            }\n            const alarmLine = data.alarmLine\n            this.insideVal = data.insideVal\n            this.outsideVal = data.outsideVal\n            this.foreVal = data.foreVal\n            if (alarmLine!==0&&this.insideVal >= alarmLine) {\n              this.isAlarm=true\n            }else{\n              this.isAlarm=false\n            }\n          }).catch(function (reason) {\n          console.log(reason)\n        })\n      },\n      alarmDialogSubmit: function () {\n        this.alarmDialogModal.loading = true\n        if (!this.formValidate()) {\n          return\n        }\n        let reqData = Qs.stringify(this.alarmForm, {allowDots: true})\n        $.ajax.post('/control/alarmConfigSave', reqData)\n          .then((resp) => {\n            if (resp) {\n              this.$Message.success('报警设置成功！')\n            } else {\n              this.confirmAlert('报警设置失败！')\n            }\n          }).catch(function (reason) {\n          console.log(reason)\n        })\n        this.alarmDialogCancel()\n      },\n      formValidate: function () {\n        if (this.alarmForm.alarmName == '') {\n          this.confirmAlert('报警名称不能为空')\n          return false\n        }\n        if (this.alarmForm.alarmLine == '') {\n          this.confirmAlert('报警水位不能为空')\n          return false\n        }\n        if (this.alarmForm.receivers.length==0) {\n          this.confirmAlert('通知人不能为空')\n          return false\n        }\n        return true\n      },\n      confirmAlert: function (message) {\n        const content = '<p>' + message + '</p>'\n        this.$Message.warning({\n          content: content,\n          duration: 3\n        })\n      },\n      alarmMessage: function (alarmLine) {\n        this.$Message.error({\n          background: true,\n          content: '当前内河水位已超' + alarmLine + '米的警戒水位，请及时处置！',\n          top: 50,\n          duration: 3\n        })\n      },\n      switchChange: function (flag) {\n        this.alarmForm.status = flag ? 1 : 0\n      },\n      initAlarmDialog: function () {\n        this.getWXReceivers()\n        $.ajax.post('/control/getAlarmConfig?stationId='+this.alarmForm.stationId)\n          .then((form) => {\n            if (form) {\n              this.alarmForm.id = form.id\n              this.alarmForm.alarmName = form.alarmName\n              this.alarmForm.alarmLine = form.alarmLine\n              this.alarmForm.receivers = form.receivers\n              this.alarmForm.frequency=form.frequency\n              this.alarmForm.status = form.status\n            }\n            this.alarmDialogModal.modal = true\n          }).catch(function (reason) {\n          console.log(reason)\n        })\n      },\n      alarmDialogCancel: function () {\n        this.alarmDialogModal.modal = false\n        this.alarmDialogModal.closable = true\n        this.alarmDialogModal.loading = false\n        this.alarmForm.id = null\n        this.alarmForm.status = 0\n        this.alarmForm.frequency=5\n        this.alarmForm.alarmName = \"\"\n        this.alarmForm.alarmLine = 0.00\n        this.alarmForm.receivers=[]\n      }\n    },\n    created() {\n      this.init()\n    },\n    beforeDestroy() {\n      clearInterval(this.timer);\n    },\n  }\n</script>\n\n\n<style>\n  .card-top {\n    margin-top: 10px;\n  }\n\n  .card-content {\n    margin: 10px;\n    height: 30%;\n    text-align: center;\n    align-content: center;\n    background: #57a3f3;\n  }\n\n  .card-building {\n    margin: 10px;\n    background: coral;\n    height: 50%;\n    text-align: center;\n    align-content: center;\n    font-size: 100px\n  }\n  .warnFont {\n    -webkit-text-fill-color:red;\n  }\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/pages/screen/control/vue/control.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"margin\":\"10px\"}},[_c('Button',{staticStyle:{\"margin-left\":\"22px\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.initAlarmDialog}},[_vm._v(\"水位报警设置\")]),_vm._v(\" \"),_c('card',{staticClass:\"card-top\",attrs:{\"dis-hover\":\"\"}},[_c('p',{staticStyle:{\"text-align\":\"center\"},attrs:{\"slot\":\"title\"},slot:\"title\"},[_vm._v(\"宣城市宣州区敬亭圩排涝站水位监测\")]),_vm._v(\" \"),_c('card',{staticClass:\"card-content\"},[_vm._v(\"\\n      外河水位：\"),_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"readonly\":\"\"},model:{value:(_vm.outsideVal),callback:function ($$v) {_vm.outsideVal=$$v},expression:\"outsideVal\"}}),_vm._v(\" 米\\n    \")],1),_vm._v(\" \"),_c('card',{staticClass:\"card-building\"},[_vm._v(\"\\n      泵站机房\\n    \")]),_vm._v(\" \"),_c('card',{staticClass:\"card-content\"},[_vm._v(\"\\n      前池水位：\"),_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"readonly\":\"\"},model:{value:(_vm.foreVal),callback:function ($$v) {_vm.foreVal=$$v},expression:\"foreVal\"}}),_vm._v(\" 米\\n    \")],1),_vm._v(\" \"),_c('card',{staticClass:\"card-content\",class:_vm.isAlarm ? 'warnFont' : ''},[_vm._v(\"\\n      内河水位：\"),_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"readonly\":\"\"},model:{value:(_vm.insideVal),callback:function ($$v) {_vm.insideVal=$$v},expression:\"insideVal\"}}),_vm._v(\" 米\\n    \")],1)],1),_vm._v(\" \"),_c('Modal',{attrs:{\"title\":\"水位告警配置\",\"closable\":false,\"width\":\"45\",\"closable\":\"\",\"mask-closable\":_vm.alarmDialogModal.closable},on:{\"on-cancel\":_vm.alarmDialogCancel},model:{value:(_vm.alarmDialogModal.modal),callback:function ($$v) {_vm.$set(_vm.alarmDialogModal, \"modal\", $$v)},expression:\"alarmDialogModal.modal\"}},[_c('Form',{ref:\"alarmForm\",attrs:{\"model\":_vm.alarmForm,\"label-width\":90}},[_c('FormItem',{attrs:{\"label\":\"告警名称:\",\"prop\":\"alarmName\"}},[_c('Input',{staticStyle:{\"width\":\"400px\"},attrs:{\"placeholder\":\"请输入告警名称\",\"maxlength\":64},model:{value:(_vm.alarmForm.alarmName),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"alarmName\", $$v)},expression:\"alarmForm.alarmName\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"告警水位:\",\"prop\":\"alarmLine\"}},[_c('Input',{staticStyle:{\"width\":\"70px\"},attrs:{\"type\":\"number\"},model:{value:(_vm.alarmForm.alarmLine),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"alarmLine\", $$v)},expression:\"alarmForm.alarmLine\"}}),_vm._v(\" 米\\n      \")],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"告警开关:\",\"prop\":\"status\"}},[_c('i-switch',{attrs:{\"size\":\"large\"},on:{\"on-change\":_vm.switchChange},scopedSlots:_vm._u([{key:\"open\",fn:function(){return [_c('span',[_vm._v(\"ON\")])]},proxy:true},{key:\"close\",fn:function(){return [_c('span',[_vm._v(\"OFF\")])]},proxy:true}]),model:{value:(_vm.alarmForm.status ==1 ?true :false),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"status ==1 ?true :false\", $$v)},expression:\"alarmForm.status ==1 ?true :false\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"告警频率:\",\"prop\":\"frequency\"}},[_c('Select',{staticStyle:{\"width\":\"100px\"},model:{value:(_vm.alarmForm.frequency),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"frequency\", $$v)},expression:\"alarmForm.frequency\"}},_vm._l((_vm.frequencyList),function(f,index){return _c('Option',{key:index,attrs:{\"value\":f}},[_vm._v(_vm._s(f)+\"分钟/次\")])}),1)],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label\":\"通知人:\",\"prop\":\"receivers\"}},[_c('Select',{staticStyle:{\"width\":\"400px\"},attrs:{\"multiple\":\"\",\"filterable\":\"\",\"placeholder\":\"请选择通知人\"},model:{value:(_vm.alarmForm.receivers),callback:function ($$v) {_vm.$set(_vm.alarmForm, \"receivers\", $$v)},expression:\"alarmForm.receivers\"}},_vm._l((_vm.receiverList),function(item){return _c('Option',{key:item.id,attrs:{\"value\":item.openid}},[_vm._v(_vm._s(item.nickName))])}),1)],1)],1),_vm._v(\" \"),_c('div',{attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('Button',{attrs:{\"type\":\"text\",\"size\":\"large\"},on:{\"click\":_vm.alarmDialogCancel}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('Button',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"loading\":_vm.alarmDialogModal.loading},on:{\"click\":_vm.alarmDialogSubmit}},[_vm._v(\"保存\\n      \")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-840783ea\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/iview-loader??ref--0-1!./src/pages/screen/control/vue/control.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport iView from 'iview'\nimport VueBus from 'vue-bus'\nimport 'iview/dist/styles/iview.css'\n\n/** 自定义全局样式 **/\nimport '../../../common/css/common.css'\n\nimport controlComponent from './vue/control'\n\nVue.use(iView)\nVue.use(VueBus)\n\nnew Vue({\n  el: '#control',\n  components: {'control-component': controlComponent}\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/screen/control/control.js"],"sourceRoot":""}